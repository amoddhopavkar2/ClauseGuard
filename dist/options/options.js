"use strict";(()=>{var s={enabled:!0,onlyLegalPages:!0,sensitivity:"normal",highlightColors:{arbitration:"#ff6b6b","auto-renew":"#ffa94d","data-sharing":"#ff8787","data-retention":"#ffd43b","unilateral-changes":"#69db7c",liability:"#74c0fc","governing-law":"#b197fc"},allowlist:[],denylist:[],domainOverrides:{},skipElements:["script","style","noscript","textarea","input","code","pre","svg"]};var e=t=>new RegExp(t,"gi"),D=[{id:"arb-binding",category:"arbitration",pattern:e("binding\\s+arbitration"),severity:"critical",weight:10,description:"Requires disputes to be resolved through binding arbitration",critical:!0},{id:"arb-class-action",category:"arbitration",pattern:e("class\\s+action\\s+waiver"),severity:"critical",weight:10,description:"Waives your right to participate in class action lawsuits",critical:!0},{id:"arb-waive-right",category:"arbitration",pattern:e("waive\\s+(your|the)\\s+right\\s+to"),severity:"high",weight:8,description:"Requires you to waive certain legal rights"},{id:"arb-jury-waive",category:"arbitration",pattern:e("jury\\s+trial[^.]*waive|waive[^.]*jury\\s+trial"),severity:"critical",weight:9,description:"Waives your right to a jury trial",critical:!0},{id:"arb-no-class",category:"arbitration",pattern:e("(may\\s+not|cannot|shall\\s+not)\\s+(bring|file|pursue)[^.]*class\\s+action"),severity:"high",weight:8,description:"Prohibits bringing class action lawsuits"},{id:"arb-aaa",category:"arbitration",pattern:e("(AAA|American\\s+Arbitration\\s+Association)"),severity:"high",weight:6,description:"References American Arbitration Association rules"},{id:"arb-jams",category:"arbitration",pattern:e("\\bJAMS\\b"),severity:"high",weight:6,description:"References JAMS arbitration services"},{id:"arb-individual-basis",category:"arbitration",pattern:e("on\\s+an?\\s+individual\\s+basis\\s+only"),severity:"high",weight:7,description:"Requires claims to be brought individually, not as a group"},{id:"auto-renew-auto",category:"auto-renew",pattern:e("automatically\\s+renew"),severity:"high",weight:7,description:"Service automatically renews"},{id:"auto-renew-pattern",category:"auto-renew",pattern:e("auto-?renew(al|s|ed)?"),severity:"high",weight:7,description:"Auto-renewal clause"},{id:"auto-recurring",category:"auto-renew",pattern:e("recurring\\s+(billing|charge|payment)"),severity:"high",weight:6,description:"Recurring billing or charges"},{id:"auto-trial-convert",category:"auto-renew",pattern:e("(trial|free)[^.]{0,50}convert(s)?\\s+(to|into)\\s+(a\\s+)?(paid|subscription)"),severity:"high",weight:8,description:"Trial converts to paid subscription"},{id:"auto-cancel-before",category:"auto-renew",pattern:e("cancel[^.]{0,30}before[^.]{0,30}renewal"),severity:"medium",weight:5,description:"Must cancel before renewal date"},{id:"auto-charged-until",category:"auto-renew",pattern:e("(will\\s+be|are)\\s+charged[^.]{0,50}until\\s+(you\\s+)?cancel"),severity:"high",weight:6,description:"Charges continue until you cancel"},{id:"auto-no-refund",category:"auto-renew",pattern:e("no\\s+refunds?\\s+(will\\s+be\\s+)?(provided|given|issued)"),severity:"medium",weight:5,description:"No refunds policy"},{id:"data-share-third",category:"data-sharing",pattern:e("share[^.]{0,50}(with\\s+)?(third\\s+part(y|ies)|partners?|affiliates?)"),severity:"high",weight:7,description:"Shares data with third parties, partners, or affiliates"},{id:"data-sell-personal",category:"data-sharing",pattern:e("sell[^.]{0,30}(personal\\s+(information|data)|your\\s+(data|information))"),severity:"critical",weight:10,description:"May sell your personal information",critical:!0},{id:"data-advertising",category:"data-sharing",pattern:e("(advertising|ad)\\s+partners"),severity:"high",weight:6,description:"Shares data with advertising partners"},{id:"data-analytics",category:"data-sharing",pattern:e("analytics\\s+providers"),severity:"medium",weight:4,description:"Shares data with analytics providers"},{id:"data-disclose",category:"data-sharing",pattern:e("(may|will)\\s+disclose[^.]{0,50}(to\\s+)?(third\\s+part|government|law\\s+enforcement)"),severity:"medium",weight:5,description:"May disclose data to third parties or authorities"},{id:"data-transfer",category:"data-sharing",pattern:e("transfer[^.]{0,30}(your\\s+)?(personal\\s+)?(data|information)[^.]{0,30}(to|outside)"),severity:"medium",weight:5,description:"May transfer your data"},{id:"data-marketing",category:"data-sharing",pattern:e("(use|share)[^.]{0,30}(your\\s+)?(data|information)[^.]{0,30}marketing"),severity:"high",weight:6,description:"Uses your data for marketing purposes"},{id:"ret-long",category:"data-retention",pattern:e("retain[^.]{0,50}as\\s+long\\s+as"),severity:"medium",weight:5,description:"May retain data for extended periods"},{id:"ret-indefinitely",category:"data-retention",pattern:e("(retain|store|keep)[^.]{0,30}indefinitely"),severity:"high",weight:7,description:"May retain data indefinitely"},{id:"ret-legal-business",category:"data-retention",pattern:e("for\\s+(legal|business|regulatory)\\s+purposes"),severity:"low",weight:3,description:"Retains data for legal or business purposes"},{id:"ret-continue-store",category:"data-retention",pattern:e("(may|will)\\s+continue\\s+to\\s+store"),severity:"medium",weight:5,description:"May continue storing data after account closure"},{id:"ret-after-deletion",category:"data-retention",pattern:e("(after|even\\s+if)[^.]{0,30}(delet|terminat|clos)[^.]{0,30}(retain|keep|store)"),severity:"high",weight:6,description:"May retain data even after you request deletion"},{id:"ret-backup",category:"data-retention",pattern:e("(backup|archive)[^.]{0,30}(copies|data)[^.]{0,30}(may|will|could)\\s+(remain|persist)"),severity:"medium",weight:4,description:"Backup copies may persist after deletion"},{id:"change-anytime",category:"unilateral-changes",pattern:e("(we\\s+)?(may|can|reserve\\s+the\\s+right\\s+to)\\s+(modify|change|update|amend)[^.]{0,30}at\\s+any\\s+time"),severity:"medium",weight:5,description:"Terms may be changed at any time"},{id:"change-without-notice",category:"unilateral-changes",pattern:e("without\\s+(prior\\s+)?notice"),severity:"high",weight:6,description:"Changes may be made without notice"},{id:"change-continued-use",category:"unilateral-changes",pattern:e("continued\\s+use[^.]{0,50}(constitutes|means|indicates)\\s+(acceptance|agreement)"),severity:"medium",weight:5,description:"Continued use means you accept changes"},{id:"change-sole-discretion",category:"unilateral-changes",pattern:e("(in\\s+)?(our|its)\\s+sole\\s+(and\\s+absolute\\s+)?discretion"),severity:"medium",weight:4,description:"Company can make decisions at sole discretion"},{id:"change-terminate",category:"unilateral-changes",pattern:e("(may|can|reserve[^.]{0,20}right[^.]{0,10})\\s+terminat[^.]{0,30}(at\\s+any\\s+time|without\\s+(cause|reason))"),severity:"high",weight:6,description:"Service may be terminated at any time without cause"},{id:"liab-maximum",category:"liability",pattern:e("to\\s+the\\s+(maximum|fullest)\\s+extent\\s+permitted"),severity:"medium",weight:4,description:"Limits liability to maximum extent permitted by law"},{id:"liab-limitation",category:"liability",pattern:e("limitation\\s+of\\s+liability"),severity:"medium",weight:4,description:"Liability limitation clause"},{id:"liab-not-liable",category:"liability",pattern:e("(shall\\s+)?not\\s+(be\\s+)?(liable|responsible)\\s+for"),severity:"medium",weight:4,description:"Disclaims liability for certain issues"},{id:"liab-damages",category:"liability",pattern:e("(consequential|incidental|punitive|indirect|special)\\s+damages"),severity:"medium",weight:4,description:"Excludes certain types of damages"},{id:"liab-warranty",category:"liability",pattern:e("(disclaim|exclude)[^.]{0,30}warrant(y|ies)"),severity:"medium",weight:4,description:"Disclaims warranties"},{id:"liab-as-is",category:"liability",pattern:e('"?as\\s+is"?\\s+(and\\s+"?as\\s+available"?)?\\s+basis'),severity:"low",weight:3,description:'Service provided "as is" without guarantees'},{id:"liab-indemnify",category:"liability",pattern:e("(you\\s+)?(agree\\s+to\\s+)?indemnify[^.]{0,50}(us|company|service)"),severity:"medium",weight:5,description:"Requires you to indemnify the company"},{id:"gov-laws",category:"governing-law",pattern:e("governed\\s+by\\s+the\\s+laws\\s+of"),severity:"low",weight:2,description:"Specifies governing law jurisdiction"},{id:"gov-exclusive",category:"governing-law",pattern:e("exclusive\\s+(jurisdiction|venue)"),severity:"medium",weight:4,description:"Requires disputes in specific jurisdiction"},{id:"gov-venue",category:"governing-law",pattern:e("venue[^.]{0,30}shall\\s+be"),severity:"low",weight:3,description:"Specifies legal venue"},{id:"gov-waive-venue",category:"governing-law",pattern:e("waive[^.]{0,30}(objection|right)[^.]{0,30}venue"),severity:"medium",weight:5,description:"Waives right to object to venue"}];async function c(){try{let t=await chrome.storage.sync.get("settings");if(t.settings)return{...s,...t.settings};let a=await chrome.storage.local.get("settings");return a.settings?{...s,...a.settings}:s}catch(t){return console.error("ClauseGuard: Error loading settings:",t),s}}async function S(t){let l={...await c(),...t};try{await chrome.storage.sync.set({settings:l})}catch(r){console.warn("ClauseGuard: Sync storage failed, using local:",r),await chrome.storage.local.set({settings:l})}}var d=document.getElementById("setting-enabled"),g=document.getElementById("setting-only-legal"),u=document.getElementById("setting-sensitivity"),I=document.getElementById("reset-colors"),v=document.getElementById("allowlist"),m=document.getElementById("allowlist-input"),A=document.getElementById("allowlist-add"),b=document.getElementById("denylist"),p=document.getElementById("denylist-input"),R=document.getElementById("denylist-add"),y=document.getElementById("toast"),h={arbitration:document.getElementById("color-arbitration"),"auto-renew":document.getElementById("color-auto-renew"),"data-sharing":document.getElementById("color-data-sharing"),"data-retention":document.getElementById("color-data-retention"),"unilateral-changes":document.getElementById("color-unilateral-changes"),liability:document.getElementById("color-liability"),"governing-law":document.getElementById("color-governing-law")},i;function k(t="Settings saved"){let a=y.querySelector(".toast-message");a&&(a.textContent=t),y.classList.add("visible"),setTimeout(()=>{y.classList.remove("visible")},2e3)}async function n(){await S(i),k()}function o(t,a,l){if(a.length===0){t.innerHTML='<span style="color: #868e96; font-size: 13px;">No domains added</span>';return}t.innerHTML=a.map(r=>`
      <span class="domain-tag" data-domain="${r}">
        ${r}
        <button class="domain-remove" data-domain="${r}" title="Remove">\xD7</button>
      </span>
    `).join(""),t.querySelectorAll(".domain-remove").forEach(r=>{r.addEventListener("click",M=>{let E=M.currentTarget.dataset.domain;E&&l(E)})})}function C(t){return/^(\*\.)?([a-zA-Z0-9]([a-zA-Z0-9-]*[a-zA-Z0-9])?\.)+[a-zA-Z]{2,}$/.test(t)||/^([a-zA-Z0-9]([a-zA-Z0-9-]*[a-zA-Z0-9])?\.)+[a-zA-Z]{2,}$/.test(t)}function T(){let t=m.value.trim().toLowerCase();if(t){if(!C(t)){alert("Please enter a valid domain (e.g., example.com or *.example.com)");return}if(i.allowlist.includes(t)){alert("This domain is already in the allowlist");return}i.allowlist.push(t),m.value="",o(v,i.allowlist,w),n()}}function w(t){i.allowlist=i.allowlist.filter(a=>a!==t),o(v,i.allowlist,w),n()}function L(){let t=p.value.trim().toLowerCase();if(t){if(!C(t)){alert("Please enter a valid domain (e.g., example.com or *.example.com)");return}if(i.denylist.includes(t)){alert("This domain is already in the denylist");return}i.denylist.push(t),p.value="",o(b,i.denylist,f),n()}}function f(t){i.denylist=i.denylist.filter(a=>a!==t),o(b,i.denylist,f),n()}function P(){i.highlightColors={...s.highlightColors},Object.entries(h).forEach(([t,a])=>{a.value=i.highlightColors[t]}),n()}async function x(){i=await c(),d.checked=i.enabled,g.checked=i.onlyLegalPages,u.value=i.sensitivity,Object.entries(h).forEach(([t,a])=>{a.value=i.highlightColors[t]}),o(v,i.allowlist,w),o(b,i.denylist,f),d.addEventListener("change",()=>{i.enabled=d.checked,n()}),g.addEventListener("change",()=>{i.onlyLegalPages=g.checked,n()}),u.addEventListener("change",()=>{i.sensitivity=u.value,n()}),Object.entries(h).forEach(([t,a])=>{a.addEventListener("change",()=>{i.highlightColors[t]=a.value,n()})}),I.addEventListener("click",P),A.addEventListener("click",T),R.addEventListener("click",L),m.addEventListener("keypress",t=>{t.key==="Enter"&&T()}),p.addEventListener("keypress",t=>{t.key==="Enter"&&L()})}document.addEventListener("DOMContentLoaded",x);x();})();
